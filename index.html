<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ÿ£ŸÑÿπÿßÿ® RedSword | ñ§ç</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    /* Your existing CSS (banner2-img to password-error) */
    .banner2-img {
      width: 100%;
      max-width: 1500px;
      height: auto;
      display: block;
      margin: 0 auto;
    }
      
    .banner-img {
      width: 100%;
      max-width: 1500px;
      height: 80px;
      object-fit: cover;
      display: block;
      margin: 0 auto;
    }
        
    :root {
      --primary: #f0db4f;
      --secondary: #61dafb;
      --dark: #1e1e1e;
      --darker: #141414;
      --gray: #2c2c2c;
      --light-gray: #3a3a3a;
      --text: #fff;
      --text-secondary: #ccc;
      --success: #4CAF50;
      --warning: #FFC107;
      --danger: #F44336;
    }
        
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
        
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, var(--darker), var(--dark));
      color: var(--text);
      min-height: 100vh;
      padding: 20px;
      text-align: center;
    }
        
    .container {
      max-width: 1200px;
      margin: 0 auto;
    }
        
    /* Header Styles */
    header {
      margin-bottom: 30px;
      padding: 20px;
      position: relative;
      overflow: hidden;
    }
        
    .logo {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px;
      margin-bottom: 15px;
    }
        
    .logo-icon {
      font-size: 2.5rem;
      color: var(--primary);
      text-shadow: 0 0 15px rgba(240, 219, 79, 0.5);
    }
        
    h1 {
      font-size: 2.8rem;
      background: linear-gradient(to right, var(--primary), var(--secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin: 0;
      letter-spacing: -1px;
    }
        
    .subtitle {
      color: var(--text-secondary);
      font-size: 1.2rem;
      max-width: 600px;
      margin: 0 auto 25px;
      line-height: 1.6;
    }
        
    /* Search and Filter Styles */
    .search-section {
      background: rgba(44, 44, 44, 0.7);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      padding: 25px;
      margin: 0 auto 40px;
      max-width: 800px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
        
    #searchBox {
      position: relative;
      margin-bottom: 25px;
    }
        
    #searchInput {
      width: 100%;
      padding: 15px 20px 15px 50px;
      font-size: 1.1rem;
      border-radius: 50px;
      border: 2px solid transparent;
      background: rgba(30, 30, 30, 0.8);
      color: var(--text);
      transition: all 0.3s ease;
    }
        
    #searchInput:focus {
      border-color: var(--primary);
      outline: none;
      box-shadow: 0 0 15px rgba(240, 219, 79, 0.3);
    }
        
    #searchBox i {
      position: absolute;
      left: 20px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--text-secondary);
      font-size: 1.2rem;
    }
        
    .filters {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 12px;
      margin-top: 20px;
    }
        
    .filter-btn {
      background: var(--gray);
      color: var(--text);
      border: none;
      padding: 10px 20px;
      border-radius: 50px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 0.95rem;
      display: flex;
      align-items: center;
      gap: 8px;
    }
        
    .filter-btn:hover, .filter-btn.active {
      background: var(--primary);
      color: var(--dark);
    }
        
    /* Game Grid */
    .game-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 30px;
      margin: 0 auto;
    }
        
    .game-card {
      background: var(--gray);
      border-radius: 15px;
      overflow: hidden;
      transition: all 0.4s ease;
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
      position: relative;
      height: 100%;
      display: flex;
      flex-direction: column;
    }
        
    .game-card:hover {
      transform: translateY(-10px);
      box-shadow: 0 15px 30px rgba(0, 0, 0, 0.3), 0 0 0 2px var(--primary);
    }
        
    .game-image {
      width: 100%;
      height: 260px;
      position: relative;
      overflow: hidden;
    }
        
    .game-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.5s ease;
    }
        
    .game-card:hover .game-image img {
      transform: scale(1.05);
    }
        
    .game-badge {
      position: absolute;
      top: 15px;
      left: 15px;
      background: var(--primary);
      color: var(--dark);
      padding: 5px 12px;
      border-radius: 20px;
      font-size: 0.85rem;
      font-weight: bold;
      z-index: 2;
    }
        
    .game-content {
      padding: 20px;
      flex-grow: 1;
      display: flex;
      flex-direction: column;
    }
        
    .game-card h2 {
      color: var(--secondary);
      margin-bottom: 12px;
      font-size: 1.5rem;
    }
        
    .game-card p {
      color: var(--text-secondary);
      line-height: 1.6;
      margin-bottom: 20px;
      flex-grow: 1;
    }
        
    .game-card .game-links { /* New style for action buttons */
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
        margin-top: auto; /* Push to bottom */
    }

    .game-card .game-links a,
    .game-card .game-links button {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        padding: 12px 15px;
        border-radius: 8px;
        text-decoration: none;
        font-weight: bold;
        transition: all 0.3s ease;
        gap: 8px;
        font-size: 0.95rem; /* Slightly smaller for multiple buttons */
        border: none;
        cursor: pointer;
        flex-grow: 1; /* Allow buttons to grow */
        min-width: 100px; /* Minimum width for buttons */
    }
        
    .game-card a.play-btn { /* Changed class for play button */
      background: linear-gradient(to right, var(--primary), #e6c926);
      color: var(--dark);
    }
        
    .game-card a.play-btn:hover { /* Changed class for play button */
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(240, 219, 79, 0.4);
    }

    /* New styles for admin buttons */
    .game-card button.edit-btn {
        background: linear-gradient(to right, var(--secondary), #4da6ff); /* Blueish */
        color: var(--dark);
    }
    .game-card button.edit-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 5px 15px rgba(97, 218, 251, 0.4);
    }

    .game-card button.delete-btn {
        background: linear-gradient(to right, var(--danger), #e04b4b); /* Reddish */
        color: white;
    }
    .game-card button.delete-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 5px 15px rgba(244, 67, 54, 0.4);
    }
        
    /* Stats and Info */
    .game-stats {
      display: flex;
      justify-content: space-between;
      margin-top: 15px;
      padding-top: 15px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
      font-size: 0.9rem;
      color: var(--text-secondary);
    }
        
    .stat {
      display: flex;
      align-items: center;
      gap: 5px;
    }
        
    /* Footer */
    footer {
      margin-top: 60px;
      padding: 30px;
      color: var(--text-secondary);
      font-size: 0.9rem;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }
        
    /* Admin Section Styles */
    .admin-tools-section {
      background: rgba(44, 44, 44, 0.7);
      border-radius: 15px;
      padding: 30px;
      margin: 40px auto;
      max-width: 900px; /* Wider for admin content */
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.1);
      display: none; /* Hidden by default */
      text-align: right; /* For form labels */
    }
    .admin-tools-section.visible {
        display: block;
    }

    .admin-tools-section h2 {
      color: var(--primary);
      margin-bottom: 25px;
      font-size: 1.8rem;
      text-align: center;
    }

    .admin-tabs {
        display: flex;
        justify-content: center;
        margin-bottom: 30px;
        gap: 15px;
        border-bottom: 2px solid rgba(255,255,255,0.1);
        padding-bottom: 15px;
    }

    .admin-tab-btn {
        background: var(--gray);
        color: var(--text-secondary);
        border: none;
        padding: 12px 25px;
        border-radius: 10px 10px 0 0;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 1rem;
        font-weight: bold;
    }

    .admin-tab-btn.active {
        background: var(--primary);
        color: var(--dark);
        box-shadow: 0 -5px 15px rgba(240, 219, 79, 0.3);
    }

    .tab-content {
        display: none; /* Hide tab content by default */
        padding-top: 20px;
    }
    .tab-content.active {
        display: block; /* Show active tab content */
    }

    /* Form Group for admin */
    .form-group {
      margin-bottom: 20px;
      text-align: right;
    }
        
    .form-group label {
      display: block;
      margin-bottom: 8px;
      color: var(--text);
      font-weight: bold;
    }
        
    .form-group input, 
    .form-group textarea, 
    .form-group select {
      width: 100%;
      padding: 12px 15px;
      border-radius: 8px;
      border: 2px solid transparent;
      background: rgba(30, 30, 30, 0.8);
      color: var(--text);
      font-size: 1rem;
    }
        
    .form-group input:focus, 
    .form-group textarea:focus, 
    .form-group select:focus {
      border-color: var(--primary);
      outline: none;
      box-shadow: 0 0 10px rgba(240, 219, 79, 0.3);
    }
        
    .form-group textarea {
      min-height: 100px;
      resize: vertical;
    }
        
    .add-btn, .update-password-btn { /* Combined styles for primary action buttons */
      background: linear-gradient(to right, var(--success), #43a047);
      color: white;
      border: none;
      padding: 15px 30px;
      border-radius: 8px;
      font-size: 1.1rem;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      width: 100%;
      margin-top: 10px;
    }
        
    .add-btn:hover, .update-password-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4);
    }

    /* Game Management List */
    .game-management-list {
        display: grid;
        grid-template-columns: 1fr;
        gap: 15px;
        margin-top: 20px;
    }

    .game-management-item {
        background: var(--light-gray);
        padding: 15px;
        border-radius: 10px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        flex-wrap: wrap; /* Allow wrapping on smaller screens */
        gap: 10px;
    }

    .game-management-item span {
        font-size: 1.1rem;
        color: var(--text);
        flex-grow: 1; /* Allow name to take space */
        text-align: right;
    }

    .game-management-item .actions {
        display: flex;
        gap: 10px;
    }

    .game-management-item .actions button {
        padding: 8px 15px;
        border-radius: 8px;
        border: none;
        font-size: 0.9rem;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .game-management-item .actions .edit-btn-small {
        background: var(--secondary);
        color: var(--dark);
    }
    .game-management-item .actions .delete-btn-small {
        background: var(--danger);
        color: white;
    }
    .game-management-item .actions button:hover {
        transform: translateY(-2px);
        opacity: 0.9;
    }

    /* Edit Game Form within Admin Panel */
    .edit-game-form {
        margin-top: 30px;
        border-top: 1px solid rgba(255,255,255,0.1);
        padding-top: 20px;
        display: none; /* Hidden by default */
    }
    .edit-game-form.active {
        display: block;
    }

    .edit-game-form h3 {
        color: var(--secondary);
        margin-bottom: 20px;
        text-align: center;
        font-size: 1.6rem;
    }

    .edit-game-form .form-actions {
        display: flex;
        gap: 15px;
        margin-top: 20px;
    }
    .edit-game-form .form-actions button {
        flex-grow: 1;
        padding: 12px 20px;
        font-size: 1rem;
        border-radius: 8px;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
    }
    .edit-game-form .form-actions .save-btn {
        background: var(--primary);
        color: var(--dark);
        border: none;
    }
    .edit-game-form .form-actions .save-btn:hover {
        box-shadow: 0 5px 15px rgba(240, 219, 79, 0.4);
        transform: translateY(-3px);
    }
    .edit-game-form .form-actions .cancel-btn {
        background: var(--gray);
        color: var(--text);
        border: 1px solid var(--light-gray);
    }
    .edit-game-form .form-actions .cancel-btn:hover {
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        transform: translateY(-3px);
    }


    /* Secret Button */
    .secret-btn {
      position: fixed;
      bottom: 20px;
      left: 20px;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: var(--primary);
      color: var(--dark);
      border: none;
      font-size: 1.2rem;
      cursor: pointer;
      box-shadow: 0 4px 10px rgba(0,0,0,0.3);
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
    }
        
    .secret-btn:hover {
      transform: scale(1.1);
      box-shadow: 0 0 15px rgba(240, 219, 79, 0.5);
    }
        
    /* Password Modal */
    .password-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 2000;
      display: none;
    }
        
    .password-modal.visible {
      display: flex;
    }
        
    .password-box {
      background: var(--gray);
      border-radius: 15px;
      padding: 30px;
      max-width: 400px;
      width: 90%;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
      border: 1px solid rgba(255, 255, 255, 0.1);
      text-align: center;
    }
        
    .password-box h2 {
      color: var(--primary);
      margin-bottom: 20px;
    }
        
    .password-input {
      width: 100%;
      padding: 15px;
      border-radius: 8px;
      background: rgba(30, 30, 30, 0.8);
      color: var(--text);
      border: 2px solid transparent;
      font-size: 1rem;
      margin-bottom: 20px;
    }
        
    .password-input:focus {
      border-color: var(--primary);
      outline: none;
      box-shadow: 0 0 10px rgba(240, 219, 79, 0.3);
    }
        
    .modal-btn {
      padding: 12px 25px;
      border-radius: 8px;
      border: none;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 1rem;
    }
        
    .submit-btn {
      background: linear-gradient(to right, var(--success), #43a047);
      color: white;
      margin-left: 10px;
    }
        
    .cancel-btn {
      background: var(--gray);
      color: var(--text);
      border: 1px solid var(--light-gray);
    }
        
    .modal-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    }
        
    /* Animations */
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
        
    .game-card {
      animation: fadeIn 0.6s ease forwards;
      opacity: 0;
    }
        
    .game-card:nth-child(2) { animation-delay: 0.1s; }
    .game-card:nth-child(3) { animation-delay: 0.2s; }
    .game-card:nth-child(4) { animation-delay: 0.3s; }
    .game-card:nth-child(5) { animation-delay: 0.4s; }
    .game-card:nth-child(6) { animation-delay: 0.5s; }
        
    /* No Results */
    .no-results {
      grid-column: 1 / -1;
      padding: 50px;
      text-align: center;
      color: var(--text-secondary);
      font-size: 1.2rem;
    }
        
    /* Responsive Design */
    @media (max-width: 768px) {
      .game-grid {
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      }
          
      h1 {
        font-size: 2.2rem;
      }
          
      .search-section {
        padding: 20px 15px;
      }
          
      .admin-tools-section { /* Also adjust for admin section */
        padding: 20px;
      }

      .game-management-item {
        flex-direction: column;
        align-items: flex-end;
      }
      .game-management-item span {
        width: 100%; /* Full width for game name */
        margin-bottom: 10px;
      }
    }
        
    @media (max-width: 480px) {
      h1 {
        font-size: 1.8rem;
      }
          
      .filters {
        gap: 8px;
      }
          
      .filter-btn {
        padding: 8px 15px;
        font-size: 0.85rem;
      }
          
      .secret-btn {
        bottom: 15px;
        left: 15px;
        width: 45px;
        height: 45px;
        font-size: 1rem;
      }
    }
        
    /* ÿµŸÅÿ≠ÿ© ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ± */
    .password-page {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, var(--darker), var(--dark));
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      padding: 20px;
      text-align: center;
    }
        
    .password-logo {
      font-size: 4rem;
      color: var(--primary);
      margin-bottom: 20px;
      text-shadow: 0 0 20px rgba(240, 219, 79, 0.7);
    }
        
    .password-title {
      font-size: 2.5rem;
      background: linear-gradient(to right, var(--primary), var(--secondary));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 20px;
    }
        
    .password-form {
      background: rgba(44, 44, 44, 0.7);
      backdrop-filter: blur(10px);
      border-radius: 15px;
      padding: 30px;
      max-width: 500px;
      width: 90%;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
        
    .password-form h2 {
      color: var(--primary);
      margin-bottom: 25px;
      font-size: 1.8rem;
    }
        
    .password-input-group {
      position: relative;
      margin-bottom: 25px;
    }
        
    .password-input-group input {
      width: 100%;
      padding: 15px 20px 15px 50px;
      font-size: 1.1rem;
      border-radius: 50px;
      border: 2px solid transparent;
      background: rgba(30, 30, 30, 0.8);
      color: var(--text);
      transition: all 0.3s ease;
    }
        
    .password-input-group input:focus {
      border-color: var(--primary);
      outline: none;
      box-shadow: 0 0 15px rgba(240, 219, 79, 0.3);
    }
        
    .password-input-group i {
      position: absolute;
      left: 20px;
      top: 50%;
      transform: translateY(-50%);
      color: var(--text-secondary);
      font-size: 1.2rem;
    }
        
    .password-submit {
      background: linear-gradient(to right, var(--primary), #e6c926);
      color: var(--dark);
      padding: 15px 30px;
      border-radius: 50px;
      font-weight: bold;
      border: none;
      font-size: 1.1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      width: 100%;
    }
        
    .password-submit:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(240, 219, 79, 0.4);
    }
        
    .password-error {
      color: var(--danger);
      margin-top: 15px;
      display: none;
    }
        
    .site-content {
      display: none;
    }
  </style>
</head>
<body>

  <div id="passwordPage" class="password-page">
    <div class="password-logo">ñ§ç</div>
    <h1 class="password-title">ŸÖŸàŸÇÿπ ÿ£ŸÑÿπÿßÿ® ñ§çRedSword</h1>
    
    <div class="password-form">
      <h2><i class="fas fa-lock"></i> ÿßŸÑÿØÿÆŸàŸÑ ÿ•ŸÑŸâ ÿßŸÑŸÖŸàŸÇÿπ</h2>
      <p>ÿßŸÑÿ±ÿ¨ÿßÿ° ÿ•ÿØÿÆÿßŸÑ ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ± ŸÑŸÑŸàÿµŸàŸÑ ÿ•ŸÑŸâ ŸÖŸàŸÇÿπ ÿßŸÑÿ£ŸÑÿπÿßÿ®</p>
      
      <div class="password-input-group">
        <i class="fas fa-key"></i>
        <input type="password" id="sitePasswordInput" placeholder="ÿ£ÿØÿÆŸÑ ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±">
      </div>
      
      <button class="password-submit" onclick="checkSitePassword()">
        <i class="fas fa-unlock"></i> ÿØÿÆŸàŸÑ
      </button>
      
      <p class="password-error" id="sitePasswordError">
        <i class="fas fa-exclamation-circle"></i> ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ± ÿ∫Ÿäÿ± ÿµÿ≠Ÿäÿ≠ÿ©ÿå ÿ≠ÿßŸàŸÑ ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ
      </p>
    </div>
  </div>
  
  <div id="siteContent" class="site-content">
    
    <img src="https://e-redsword.github.io/REDSWORD_GAME_HOME/logo5.png" alt="ÿµŸàÿ±ÿ© ÿ±ÿ£ÿ≥ ÿßŸÑŸÖŸàŸÇÿπ" class="banner2-img">
      
    <img src="https://e-redsword.github.io/REDSWORD_GAME_HOME/RED2.png" alt="ÿµŸàÿ±ÿ© ÿ±ÿ£ÿ≥ ÿßŸÑŸÖŸàŸÇÿπ" class="banner-img">
    
    <div class="container">
      <header>
        <div class="logo">
          <div class="logo-icon">ñ§ç</div>
          <h1>ŸÖŸàŸÇÿπ ÿ£ŸÑÿπÿßÿ® ñ§çRedSword</h1>
        </div>
        <div class="logo-icon">ñ§ç</div>
          <h1>ÿ™ÿµŸÖŸäŸÖ Ÿàÿ™ÿ∑ŸàŸäÿ±  ñ§ç|ùêëùêÑùêÉùêíùêñùêéùêëùêÉüá¶üá∑</h1>
      </div>
        <p class="subtitle">ÿßÿ≥ÿ™ŸÉÿ¥ŸÅ ŸÖÿ¨ŸÖŸàÿπÿ© ÿ£ŸÑÿπÿßÿ®ŸÜÿß ÿßŸÑŸÖÿ´Ÿäÿ±ÿ© ŸàÿßŸÑŸÖŸÖÿ™ÿπÿ© ÿßŸÑÿ™Ÿä ÿ™ŸÇÿØŸÖ ÿ™ÿ¨ÿßÿ±ÿ® ŸÅÿ±ŸäÿØÿ© Ÿàÿ™ÿ≠ÿØŸäÿßÿ™ ŸÖŸÖÿ™ÿπÿ© ŸÑŸÑÿßÿπÿ®ŸäŸÜ</p>
      </header>
      
      <section class="search-section">
        <div id="searchBox">
          <i class="fas fa-search"></i>
          <input type="text" id="searchInput" placeholder="ÿßÿ®ÿ≠ÿ´ ÿπŸÜ ŸÑÿπÿ®ÿ©..." onkeyup="filterGames()">
        </div>
        
        <div class="filters">
          <button class="filter-btn active" data-category="all">
            <i class="fas fa-gamepad"></i> ÿßŸÑŸÉŸÑ
          </button>
          <button class="filter-btn" data-category="strategy">
            <i class="fas fa-chess"></i> ÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿ©
          </button>
          <button class="filter-btn" data-category="puzzle">
            <i class="fas fa-puzzle-piece"></i> ÿ£ŸÑÿ∫ÿßÿ≤
          </button>
          <button class="filter-btn" data-category="adventure">
            <i class="fas fa-map"></i> ŸÖÿ∫ÿßŸÖÿ±ÿ©
          </button>
        </div>
      </section>
      
      <div class="game-grid" id="gameGrid">
          </div>
      
      <section class="admin-tools-section" id="adminToolsSection">
        <h2><i class="fas fa-tools"></i> ŸÑŸàÿ≠ÿ© ÿ™ÿ≠ŸÉŸÖ ÿßŸÑÿ•ÿØÿßÿ±ÿ©</h2>

        <div class="admin-tabs">
            <button class="admin-tab-btn active" data-tab="games"><i class="fas fa-gamepad"></i> ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ£ŸÑÿπÿßÿ®</button>
            <button class="admin-tab-btn" data-tab="passwords"><i class="fas fa-lock"></i> ÿ•ÿØÿßÿ±ÿ© ŸÉŸÑŸÖÿßÿ™ ÿßŸÑŸÖÿ±Ÿàÿ±</button>
        </div>

        <div id="gamesTab" class="tab-content active">
            <h3><i class="fas fa-plus-circle"></i> ÿ•ÿ∂ÿßŸÅÿ© ŸÑÿπÿ®ÿ© ÿ¨ÿØŸäÿØÿ©</h3>
            <div class="form-group">
                <label for="gameName">ÿßÿ≥ŸÖ ÿßŸÑŸÑÿπÿ®ÿ©:</label>
                <input type="text" id="gameName" placeholder="ÿ£ÿØÿÆŸÑ ÿßÿ≥ŸÖ ÿßŸÑŸÑÿπÿ®ÿ©">
            </div>
            <div class="form-group">
                <label for="gameDescription">ŸàÿµŸÅ ÿßŸÑŸÑÿπÿ®ÿ©:</label>
                <textarea id="gameDescription" placeholder="ÿ£ÿØÿÆŸÑ ŸàÿµŸÅŸãÿß ŸÖÿÆÿ™ÿµÿ±Ÿãÿß ŸÑŸÑÿπÿ®ÿ©"></textarea>
            </div>
            <div class="form-group">
                <label for="gameCategory">ÿ™ÿµŸÜŸäŸÅ ÿßŸÑŸÑÿπÿ®ÿ©:</label>
                <select id="gameCategory">
                    <option value="strategy">ÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿ©</option>
                    <option value="puzzle">ÿ£ŸÑÿ∫ÿßÿ≤</option>
                    <option value="adventure">ŸÖÿ∫ÿßŸÖÿ±ÿ©</option>
                </select>
            </div>
            <div class="form-group">
                <label for="gameImage">ÿ±ÿßÿ®ÿ∑ ÿµŸàÿ±ÿ© ÿßŸÑÿ∫ŸÑÿßŸÅ:</label>
                <input type="text" id="gameImage" placeholder="ÿ£ÿØÿÆŸÑ ÿ±ÿßÿ®ÿ∑ ÿµŸàÿ±ÿ© ÿßŸÑÿ∫ŸÑÿßŸÅ">
            </div>
            <div class="form-group">
                <label for="gameLink">ÿ±ÿßÿ®ÿ∑ ÿßŸÑŸÑÿπÿ®ÿ©:</label>
                <input type="text" id="gameLink" placeholder="ÿ£ÿØÿÆŸÑ ÿ±ÿßÿ®ÿ∑ ÿßŸÑŸÑÿπÿ®ÿ©">
            </div>
             <div class="form-group">
                <label for="gameBadge">ÿ¥ÿßÿ±ÿ© ÿßŸÑŸÑÿπÿ®ÿ© (ÿßÿÆÿ™Ÿäÿßÿ±Ÿäÿå ŸÖÿ´ŸÑ "ÿ¨ÿØŸäÿØ", "ÿ¥ÿßÿ¶ÿπ"):</label>
                <input type="text" id="gameBadge" placeholder="ŸÖÿ´ŸÑ ÿ¨ÿØŸäÿØ, ÿ¥ÿßÿ¶ÿπ">
            </div>
            <div class="form-group">
                <label for="gameRating">ÿßŸÑÿ™ŸÇŸäŸäŸÖ (ÿßÿÆÿ™Ÿäÿßÿ±Ÿäÿå ŸÖÿ´ÿßŸÑ: 4.7):</label>
                <input type="number" id="gameRating" step="0.1" min="1" max="5" placeholder="ŸÖÿ´ÿßŸÑ: 4.7">
            </div>
            <div class="form-group">
                <label for="gamePlayers">ÿπÿØÿØ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ (ÿßÿÆÿ™Ÿäÿßÿ±Ÿäÿå ŸÖÿ´ÿßŸÑ: 2-6 ŸÑÿßÿπÿ®ŸäŸÜ):</label>
                <input type="text" id="gamePlayers" placeholder="ŸÖÿ´ÿßŸÑ: 2-6 ŸÑÿßÿπÿ®ŸäŸÜ">
            </div>
            <div class="form-group">
                <label for="gameTime">ŸÖÿ™Ÿàÿ≥ÿ∑ ÿßŸÑŸàŸÇÿ™ (ÿßÿÆÿ™Ÿäÿßÿ±Ÿäÿå ŸÖÿ´ÿßŸÑ: 20 ÿØŸÇŸäŸÇÿ©):</label>
                <input type="text" id="gameTime" placeholder="ŸÖÿ´ÿßŸÑ: 20 ÿØŸÇŸäŸÇÿ©">
            </div>
            
            <button class="add-btn" onclick="addNewGame()">
                <i class="fas fa-plus"></i> ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑŸÑÿπÿ®ÿ©
            </button>

            <h3><i class="fas fa-edit"></i> ÿ™ÿπÿØŸäŸÑ Ÿàÿ≠ÿ∞ŸÅ ÿßŸÑÿ£ŸÑÿπÿßÿ®</h3>
            <div id="gameManagementList" class="game-management-list">
                </div>

            <div id="editGameForm" class="edit-game-form">
                <h3>ÿ™ÿπÿØŸäŸÑ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÑÿπÿ®ÿ©</h3>
                <input type="hidden" id="editGameId">
                <div class="form-group">
                    <label for="editGameName">ÿßÿ≥ŸÖ ÿßŸÑŸÑÿπÿ®ÿ©:</label>
                    <input type="text" id="editGameName">
                </div>
                <div class="form-group">
                    <label for="editGameDescription">ŸàÿµŸÅ ÿßŸÑŸÑÿπÿ®ÿ©:</label>
                    <textarea id="editGameDescription"></textarea>
                </div>
                <div class="form-group">
                    <label for="editGameCategory">ÿ™ÿµŸÜŸäŸÅ ÿßŸÑŸÑÿπÿ®ÿ©:</label>
                    <select id="editGameCategory">
                        <option value="strategy">ÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿ©</option>
                        <option value="puzzle">ÿ£ŸÑÿ∫ÿßÿ≤</option>
                        <option value="adventure">ŸÖÿ∫ÿßŸÖÿ±ÿ©</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="editGameImage">ÿ±ÿßÿ®ÿ∑ ÿµŸàÿ±ÿ© ÿßŸÑÿ∫ŸÑÿßŸÅ:</label>
                    <input type="text" id="editGameImage">
                </div>
                <div class="form-group">
                    <label for="editGameLink">ÿ±ÿßÿ®ÿ∑ ÿßŸÑŸÑÿπÿ®ÿ©:</label>
                    <input type="text" id="editGameLink">
                </div>
                <div class="form-group">
                    <label for="editGameBadge">ÿ¥ÿßÿ±ÿ© ÿßŸÑŸÑÿπÿ®ÿ© (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä):</label>
                    <input type="text" id="editGameBadge">
                </div>
                <div class="form-group">
                    <label for="editGameRating">ÿßŸÑÿ™ŸÇŸäŸäŸÖ (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä):</label>
                    <input type="number" id="editGameRating" step="0.1" min="1" max="5">
                </div>
                <div class="form-group">
                    <label for="editGamePlayers">ÿπÿØÿØ ÿßŸÑŸÑÿßÿπÿ®ŸäŸÜ (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä):</label>
                    <input type="text" id="editGamePlayers">
                </div>
                <div class="form-group">
                    <label for="editGameTime">ŸÖÿ™Ÿàÿ≥ÿ∑ ÿßŸÑŸàŸÇÿ™ (ÿßÿÆÿ™Ÿäÿßÿ±Ÿä):</label>
                    <input type="text" id="editGameTime">
                </div>
                <div class="form-actions">
                    <button class="save-btn" onclick="updateGame()"><i class="fas fa-save"></i> ÿ≠ŸÅÿ∏ ÿßŸÑÿ™ÿπÿØŸäŸÑÿßÿ™</button>
                    <button class="cancel-btn" onclick="cancelEditGame()"><i class="fas fa-times"></i> ÿ•ŸÑÿ∫ÿßÿ°</button>
                </div>
            </div>
        </div>

        <div id="passwordsTab" class="tab-content">
            <h3><i class="fas fa-key"></i> ÿ™ÿ∫ŸäŸäÿ± ŸÉŸÑŸÖÿßÿ™ ÿßŸÑŸÖÿ±Ÿàÿ±</h3>
            <div class="form-group">
                <label for="newSitePassword">ŸÉŸÑŸÖÿ© ŸÖÿ±Ÿàÿ± ÿßŸÑŸÖŸàŸÇÿπ ÿßŸÑÿ¨ÿØŸäÿØÿ©:</label>
                <input type="password" id="newSitePassword" placeholder="ÿ£ÿØÿÆŸÑ ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ± ÿßŸÑÿ¨ÿØŸäÿØÿ© ŸÑŸÑŸÖŸàŸÇÿπ">
            </div>
            <div class="form-group">
                <label for="confirmNewSitePassword">ÿ™ÿ£ŸÉŸäÿØ ŸÉŸÑŸÖÿ© ŸÖÿ±Ÿàÿ± ÿßŸÑŸÖŸàŸÇÿπ ÿßŸÑÿ¨ÿØŸäÿØÿ©:</label>
                <input type="password" id="confirmNewSitePassword" placeholder="ÿ£ÿπÿØ ÿ•ÿØÿÆÿßŸÑ ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ± ÿßŸÑÿ¨ÿØŸäÿØÿ© ŸÑŸÑŸÖŸàŸÇÿπ">
            </div>
            <p id="sitePasswordMessage" style="color: var(--danger); display: none; margin-bottom: 15px;"></p>
            <button class="update-password-btn" onclick="updateSitePassword()"><i class="fas fa-sync-alt"></i> ÿ™ÿ≠ÿØŸäÿ´ ŸÉŸÑŸÖÿ© ŸÖÿ±Ÿàÿ± ÿßŸÑŸÖŸàŸÇÿπ</button>

            <h3 style="margin-top: 40px;"><i class="fas fa-user-lock"></i> ÿ™ÿ∫ŸäŸäÿ± ŸÉŸÑŸÖÿ© ŸÖÿ±Ÿàÿ± ÿßŸÑÿ•ÿØÿßÿ±ÿ©</h3>
            <div class="form-group">
                <label for="newAdminPassword">ŸÉŸÑŸÖÿ© ŸÖÿ±Ÿàÿ± ÿßŸÑÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ¨ÿØŸäÿØÿ©:</label>
                <input type="password" id="newAdminPassword" placeholder="ÿ£ÿØÿÆŸÑ ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ± ÿßŸÑÿ¨ÿØŸäÿØÿ© ŸÑŸÑÿ•ÿØÿßÿ±ÿ©">
            </div>
            <div class="form-group">
                <label for="confirmNewAdminPassword">ÿ™ÿ£ŸÉŸäÿØ ŸÉŸÑŸÖÿ© ŸÖÿ±Ÿàÿ± ÿßŸÑÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ¨ÿØŸäÿØÿ©:</label>
                <input type="password" id="confirmNewAdminPassword" placeholder="ÿ£ÿπÿØ ÿ•ÿØÿÆÿßŸÑ ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ± ÿßŸÑÿ¨ÿØŸäÿØÿ© ŸÑŸÑÿ•ÿØÿßÿ±ÿ©">
            </div>
            <p id="adminPasswordMessage" style="color: var(--danger); display: none; margin-bottom: 15px;"></p>
            <button class="update-password-btn" onclick="updateAdminPassword()"><i class="fas fa-sync-alt"></i> ÿ™ÿ≠ÿØŸäÿ´ ŸÉŸÑŸÖÿ© ŸÖÿ±Ÿàÿ± ÿßŸÑÿ•ÿØÿßÿ±ÿ©</button>
        </div>

      </section>
      
      <footer>
        <p>¬© 2025 ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≠ŸÇŸàŸÇ ŸÖÿ≠ŸÅŸàÿ∏ÿ© | ÿ£ŸÑÿπÿßÿ® ÿ™ÿµŸÖŸäŸÖ Ÿàÿ™ÿ∑ŸàŸäÿ± Ÿàÿ®ÿ±ŸÖÿ¨ÿ© ñ§ç|ùêëùêÑùêÉùêíùêñùêéùêëùêÉüá¶üá∑</p>
        <p>ÿµŸÖŸÖ ÿ®ÿ≠ÿ® ŸÑÿ¨ŸÖŸäÿπ ŸÖÿ≠ÿ®Ÿä ÿßŸÑÿ£ŸÑÿπÿßÿ® ÿßŸÑÿ™ŸÅÿßÿπŸÑŸäÿ© ŸàÿßŸÑÿßÿ≥ÿ™ÿ±ÿßÿ™Ÿäÿ¨Ÿäÿ© ÿπŸÑŸâ ÿ±ŸàŸÖÿßÿ™ ÿ≥ÿ™ÿßÿ± ŸÖŸäŸÉÿ± Ÿà ÿ™Ÿàÿ® ÿ™Ÿàÿ®</p>
      </footer>
    </div>
    
    <button id="secretBtn" class="secret-btn">
      <i class="fas fa-lock"></i>
    </button>
    
    <div class="password-modal" id="passwordModal">
      <div class="password-box">
        <h2><i class="fas fa-key"></i> ÿßŸÑÿ±ŸÖÿ≤ ÿßŸÑÿ≥ÿ±Ÿä</h2>
        <p>ÿ£ÿØÿÆŸÑ ÿßŸÑÿ±ŸÖÿ≤ ÿßŸÑÿ≥ÿ±Ÿä ŸÑŸÑŸàÿµŸàŸÑ ÿ•ŸÑŸâ ÿ£ÿØŸàÿßÿ™ ÿßŸÑÿ•ÿØÿßÿ±ÿ©</p>
        <input type="password" id="adminPasswordInput" class="password-input" placeholder="ÿ£ÿØÿÆŸÑ ÿßŸÑÿ±ŸÖÿ≤ ÿßŸÑÿ≥ÿ±Ÿä">
        <div>
          <button class="modal-btn submit-btn" onclick="checkAdminPassword()">ÿØÿÆŸàŸÑ</button>
          <button class="modal-btn cancel-btn" onclick="closePasswordModal()">ÿ•ŸÑÿ∫ÿßÿ°</button>
        </div>
      </div>
    </div>
  </div> 

  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
  <script>
    // 1. Firebase Configuration - ÿßÿ≥ÿ™ÿ®ÿØŸÑ Ÿáÿ∞Ÿá ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿ®ÿ®ŸäÿßŸÜÿßÿ™ ŸÖÿ¥ÿ±ŸàÿπŸÉ ÿßŸÑÿÆÿßÿµÿ©
    const firebaseConfig = {
      apiKey: "AIzaSyCqCU1PtELEYfmM_SlMIZo9oNupHb04h1g",
      authDomain: "redsword-game.firebaseapp.com",
      databaseURL: "https://redsword-game-default-rtdb.firebaseio.com",
      projectId: "redsword-game",
      storageBucket: "redsword-game.firebasestorage.app",
      messagingSenderId: "726024757334",
      appId: "1:726024757334:web:0df237ab1c3c36f13a5bf7",
      measurementId: "G-VD4M9WVSCX"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();
    const passwordsRef = database.ref('passwords'); // ÿßŸÑÿ•ÿ¥ÿßÿ±ÿ© ÿ•ŸÑŸâ ÿπŸÇÿØÿ© ŸÉŸÑŸÖÿßÿ™ ÿßŸÑŸÖÿ±Ÿàÿ±
    const gamesRef = database.ref('games'); // ÿßŸÑÿ•ÿ¥ÿßÿ±ÿ© ÿ•ŸÑŸâ ÿπŸÇÿØÿ© ÿßŸÑÿ£ŸÑÿπÿßÿ®
    
    // ŸÖÿ™ÿ∫Ÿäÿ±ÿßÿ™ ŸÑÿ™ÿÆÿ≤ŸäŸÜ ŸÉŸÑŸÖÿßÿ™ ÿßŸÑŸÖÿ±Ÿàÿ± ŸÖŸÜ Firebase
    let SITE_PASSWORD_FIREBASE = "";
    let ADMIN_PASSWORD_FIREBASE = "";
    let IS_ADMIN_LOGGED_IN = false; // Flag to track admin status
    let allGamesData = {}; // Store all games data with their IDs for easy access

    // ÿπŸÜÿßÿµÿ± DOM ŸÑÿµŸÅÿ≠ÿ© ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ± ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©
    const passwordPage = document.getElementById('passwordPage');
    const siteContent = document.getElementById('siteContent');
    const sitePasswordInput = document.getElementById('sitePasswordInput');
    const sitePasswordError = document.getElementById('sitePasswordError');

    // ÿπŸÜÿßÿµÿ± DOM ŸÑŸÜÿßŸÅÿ∞ÿ© ŸÉŸÑŸÖÿ© ŸÖÿ±Ÿàÿ± ÿßŸÑŸÖÿ≥ÿ§ŸàŸÑ
    const secretBtn = document.getElementById('secretBtn');
    const passwordModal = document.getElementById('passwordModal');
    const adminPasswordInput = document.getElementById('adminPasswordInput');
    const adminToolsSection = document.getElementById('adminToolsSection'); // Changed from addGameSection

    // DOM elements for password management
    const newSitePasswordInput = document.getElementById('newSitePassword');
    const confirmNewSitePasswordInput = document.getElementById('confirmNewSitePassword');
    const sitePasswordMessage = document.getElementById('sitePasswordMessage');
    const newAdminPasswordInput = document.getElementById('newAdminPassword');
    const confirmNewAdminPasswordInput = document.getElementById('confirmNewAdminPassword');
    const adminPasswordMessage = document.getElementById('adminPasswordMessage');

    // DOM elements for game management forms
    const gameNameInput = document.getElementById('gameName');
    const gameDescriptionInput = document.getElementById('gameDescription');
    const gameCategorySelect = document.getElementById('gameCategory');
    const gameImageInput = document.getElementById('gameImage');
    const gameLinkInput = document.getElementById('gameLink');
    const gameBadgeInput = document.getElementById('gameBadge');
    const gameRatingInput = document.getElementById('gameRating');
    const gamePlayersInput = document.getElementById('gamePlayers');
    const gameTimeInput = document.getElementById('gameTime');

    const gameManagementList = document.getElementById('gameManagementList');
    const editGameForm = document.getElementById('editGameForm');
    const editGameIdInput = document.getElementById('editGameId');
    const editGameNameInput = document.getElementById('editGameName');
    const editGameDescriptionInput = document.getElementById('editGameDescription');
    const editGameCategorySelect = document.getElementById('editGameCategory');
    const editGameImageInput = document.getElementById('editGameImage');
    const editGameLinkInput = document.getElementById('editGameLink');
    const editGameBadgeInput = document.getElementById('editGameBadge');
    const editGameRatingInput = document.getElementById('editGameRating');
    const editGamePlayersInput = document.getElementById('editGamePlayers');
    const editGameTimeInput = document.getElementById('editGameTime');


    // 2. ÿ™ÿ≠ŸÖŸäŸÑ ŸÉŸÑŸÖÿßÿ™ ÿßŸÑŸÖÿ±Ÿàÿ± ŸÖŸÜ Firebase
    passwordsRef.on('value', (snapshot) => {
      const passwords = snapshot.val();
      if (passwords) {
        SITE_PASSWORD_FIREBASE = passwords.sitePassword || "";
        ADMIN_PASSWORD_FIREBASE = passwords.adminPassword || "";
        // console.log("Site password loaded from Firebase:", SITE_PASSWORD_FIREBASE);
        // console.log("Admin password loaded from Firebase:", ADMIN_PASSWORD_FIREBASE);
      } else {
        console.warn("No passwords found in Firebase 'passwords' node. Setting defaults.");
        // Set default passwords if they don't exist
        passwordsRef.set({
          sitePassword: "123", // Default site password
          adminPassword: "admin" // Default admin password
        }).then(() => {
          SITE_PASSWORD_FIREBASE = "123";
          ADMIN_PASSWORD_FIREBASE = "admin";
          // console.log("Default passwords set in Firebase.");
        }).catch(error => {
          console.error("Error setting default passwords:", error);
        });
      }
      // Show password page only if it's currently hidden (first load)
      if (passwordPage.style.display !== 'none' && siteContent.style.display === 'none') {
        passwordPage.style.display = 'flex';
        sitePasswordInput.focus();
      }
    }, (errorObject) => {
      console.error("The read failed: " + errorObject.code);
      sitePasswordError.textContent = `ŸÅÿ¥ŸÑ ÿ™ÿ≠ŸÖŸäŸÑ ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±: ${errorObject.code}. ÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿßÿ™ÿµÿßŸÑŸÉ ÿ®ÿßŸÑÿ•ŸÜÿ™ÿ±ŸÜÿ™ ÿ£Ÿà ŸÇŸàÿßÿπÿØ Firebase.`;
      sitePasswordError.style.display = 'block';
    });
    
    // 3. ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ŸÉŸÑŸÖÿ© ŸÖÿ±Ÿàÿ± ÿßŸÑŸÖŸàŸÇÿπ
    function checkSitePassword() {
      if (sitePasswordInput.value === SITE_PASSWORD_FIREBASE) {
        siteContent.style.display = 'block';
        passwordPage.style.display = 'none';
        sitePasswordError.style.display = 'none'; // ÿ•ÿÆŸÅÿßÿ° ÿ£Ÿä ÿ±ÿ≥ÿßŸÑÿ© ÿÆÿ∑ÿ£ ÿ≥ÿßÿ®ŸÇÿ©
      } else {
        sitePasswordError.style.display = 'block';
        sitePasswordInput.value = '';
        sitePasswordInput.focus();
        // ÿ•ÿ∂ÿßŸÅÿ© ÿßŸáÿ™ÿ≤ÿßÿ≤ ŸÑŸÑÿ•ÿ¥ÿßÿ±ÿ© ÿ•ŸÑŸâ ÿßŸÑÿÆÿ∑ÿ£
        sitePasswordInput.classList.add('shake');
        setTimeout(() => {
          sitePasswordInput.classList.remove('shake');
        }, 500);
      }
    }
    
    // 4. ÿßŸÑÿ≥ŸÖÿßÿ≠ ÿ®ÿßŸÑÿØÿÆŸàŸÑ ÿ®ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿ≤ÿ± Enter ŸÑŸÉŸÑŸÖÿ© ŸÖÿ±Ÿàÿ± ÿßŸÑŸÖŸàŸÇÿπ
    sitePasswordInput.addEventListener('keyup', function(event) {
      if (event.key === 'Enter') {
        checkSitePassword();
      }
    });

    // 5. ŸÅÿ™ÿ≠ ŸÜÿßŸÅÿ∞ÿ© ŸÉŸÑŸÖÿ© ÿ≥ÿ± ÿßŸÑŸÖÿ≥ÿ§ŸàŸÑ
    secretBtn.addEventListener('click', function() {
      passwordModal.classList.add('visible');
      adminPasswordInput.focus();
    });
    
    // 6. ÿ•ÿ∫ŸÑÿßŸÇ ŸÜÿßŸÅÿ∞ÿ© ŸÉŸÑŸÖÿ© ÿ≥ÿ± ÿßŸÑŸÖÿ≥ÿ§ŸàŸÑ
    function closePasswordModal() {
      passwordModal.classList.remove('visible');
      adminPasswordInput.value = '';
    }
    
    // 7. ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ŸÉŸÑŸÖÿ© ÿ≥ÿ± ÿßŸÑŸÖÿ≥ÿ§ŸàŸÑ Ÿàÿπÿ±ÿ∂ ŸÑŸàÿ≠ÿ© ÿßŸÑÿ•ÿØÿßÿ±ÿ©
    function checkAdminPassword() {
      if (adminPasswordInput.value === ADMIN_PASSWORD_FIREBASE) {
        adminToolsSection.classList.add('visible');
        IS_ADMIN_LOGGED_IN = true; // Set admin flag
        updateGameCardAdminButtons(); // Add admin buttons to existing game cards
        loadGamesForManagement(); // Load games into the admin list
        closePasswordModal();
        alert('ÿ™ŸÖ ŸÅÿ™ÿ≠ Ÿàÿ∂ÿπ ÿßŸÑÿ•ÿØÿßÿ±ÿ©! ŸäŸÖŸÉŸÜŸÉ ÿßŸÑÿ¢ŸÜ ÿ•ÿØÿßÿ±ÿ© ÿßŸÑÿ£ŸÑÿπÿßÿ® ŸàŸÉŸÑŸÖÿßÿ™ ÿßŸÑŸÖÿ±Ÿàÿ±.');
      } else {
        alert('ŸÉŸÑŸÖÿ© ÿßŸÑÿ≥ÿ± ÿ∫Ÿäÿ± ÿµÿ≠Ÿäÿ≠ÿ©! ÿ≠ÿßŸàŸÑ ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ.');
        adminPasswordInput.value = '';
        adminPasswordInput.focus();
      }
    }

    // 8. ÿØÿßŸÑÿ© ŸÑÿ•ÿ∂ÿßŸÅÿ© ŸÑÿπÿ®ÿ© ÿ¨ÿØŸäÿØÿ© (ÿ≥ÿ™ÿ≠ŸÅÿ∏ ŸÅŸä Firebase Realtime Database)
    function addNewGame() {
      const name = gameNameInput.value;
      const description = gameDescriptionInput.value;
      const category = gameCategorySelect.value;
      const image = gameImageInput.value;
      const link = gameLinkInput.value;
      const badge = gameBadgeInput.value || null; // Store null if empty
      const rating = gameRatingInput.value || (Math.random() * 0.5 + 4.0).toFixed(1);
      const players = gamePlayersInput.value || ['2-14', '2-14 ŸÑÿßÿπÿ®ŸäŸÜ', '14-6 ŸÑÿßÿπÿ®ŸäŸÜ'][Math.floor(Math.random() * 3)];
      const time = gameTimeInput.value || ['15 ÿØŸÇŸäŸÇÿ©', '30 ÿØŸÇŸäŸÇÿ©', '45 ÿØŸÇŸäŸÇÿ©', '60 ÿØŸÇŸäŸÇÿ©'][Math.floor(Math.random() * 4)];
      
      if (!name || !description || !image || !link) {
        alert('Ÿäÿ±ÿ¨Ÿâ ŸÖŸÑÿ° ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≠ŸÇŸàŸÑ ÿßŸÑŸÖÿ∑ŸÑŸàÿ®ÿ© (ÿßÿ≥ŸÖ, ŸàÿµŸÅ, ÿµŸàÿ±ÿ©, ÿ±ÿßÿ®ÿ∑).');
        return;
      }
      
      const newGameData = {
        name: name,
        description: description,
        category: category,
        image: image,
        link: link,
        badge: badge,
        rating: rating,
        players: players,
        time: time,
        timestamp: firebase.database.ServerValue.TIMESTAMP 
      };
      
      gamesRef.push(newGameData)
        .then(() => {
          alert(`ÿ™ŸÖÿ™ ÿ•ÿ∂ÿßŸÅÿ© "${name}" ÿ®ŸÜÿ¨ÿßÿ≠ ÿ•ŸÑŸâ Firebase!`);
          // Clear form fields
          gameNameInput.value = '';
          gameDescriptionInput.value = '';
          gameImageInput.value = '';
          gameLinkInput.value = '';
          gameBadgeInput.value = '';
          gameRatingInput.value = '';
          gamePlayersInput.value = '';
          gameTimeInput.value = '';
        })
        .catch((error) => {
          console.error("Error adding game to Firebase: ", error);
          alert("ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑŸÑÿπÿ®ÿ©: " + error.message);
        });
    }

    // 9. ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ£ŸÑÿπÿßÿ® ŸÖŸÜ Firebase Ÿàÿπÿ±ÿ∂Ÿáÿß ŸÅŸä ÿßŸÑŸàÿßÿ¨Ÿáÿ© ÿßŸÑÿ±ÿ¶Ÿäÿ≥Ÿäÿ©
    function loadGamesFromFirebase() {
        gamesRef.orderByChild('timestamp').on('value', (snapshot) => {
            const gameGrid = document.getElementById('gameGrid');
            gameGrid.innerHTML = ''; // ŸÖÿ≥ÿ≠ ÿßŸÑÿ£ŸÑÿπÿßÿ® ÿßŸÑŸÖŸàÿ¨ŸàÿØÿ© ŸÑÿ•ÿπÿßÿØÿ© ÿ®ŸÜÿßÿ¶Ÿáÿß
            const gamesData = snapshot.val();
            allGamesData = {}; // Clear previous data

            const gamesArray = [];

            if (gamesData) {
                for (let key in gamesData) {
                    allGamesData[key] = gamesData[key]; // Store for easy access by ID
                    gamesArray.push({ id: key, ...gamesData[key] }); // Store Firebase key as 'id'
                }
                gamesArray.sort((a, b) => b.timestamp - a.timestamp); // ÿßŸÑÿ£ÿ≠ÿØÿ´ ÿ£ŸàŸÑÿßŸã
            }

            if (gamesArray.length === 0) {
                const noGamesMessage = document.createElement('div');
                noGamesMessage.className = 'no-results';
                noGamesMessage.innerHTML = `<i class="fas fa-exclamation-circle" style="font-size: 3rem; margin-bottom: 20px;"></i><h3>ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ£ŸÑÿπÿßÿ® ŸÑÿπÿ±ÿ∂Ÿáÿß.</h3><p>ÿ£ÿ∂ŸÅ ÿ®ÿπÿ∂ ÿßŸÑÿ£ŸÑÿπÿßÿ® ÿßŸÑÿ¨ÿØŸäÿØÿ©!</p>`;
                gameGrid.appendChild(noGamesMessage);
            } else {
                gamesArray.forEach(game => {
                    addGameToPage(game);
                });
            }
            filterGames(); // ÿ£ÿπÿØ ÿ™ÿ∑ÿ®ŸäŸÇ ÿßŸÑŸÅŸÑÿ™ÿ±ÿ© ÿ®ÿπÿØ ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ£ŸÑÿπÿßÿ®
        }, (errorObject) => {
            console.error("The read failed: " + errorObject.code);
            const gameGrid = document.getElementById('gameGrid');
            gameGrid.innerHTML = `<div class="no-results"><i class="fas fa-exclamation-triangle" style="font-size: 3rem; margin-bottom: 20px;"></i><h3>ŸÅÿ¥ŸÑ ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ£ŸÑÿπÿßÿ®</h3><p>ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ£ŸÑÿπÿßÿ®: ${errorObject.message}.</p><p>ÿßŸÑÿ±ÿ¨ÿßÿ° ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ŸÇŸàÿßÿπÿØ Firebase ŸàÿßŸÑÿßÿ™ÿµÿßŸÑ ÿ®ÿßŸÑÿ•ŸÜÿ™ÿ±ŸÜÿ™.</p></div>`;
        });
    }

    // ÿØÿßŸÑÿ© ŸÑÿ•ÿ∂ÿßŸÅÿ© ŸÑÿπÿ®ÿ© ÿ•ŸÑŸâ ÿßŸÑÿµŸÅÿ≠ÿ© (ÿ™ŸÖ ÿ™ÿπÿØŸäŸÑŸáÿß ŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ŸÖÿ®ÿßÿ¥ÿ±ÿ© Ÿàÿ™ÿ∂ŸÖŸäŸÜ ÿ£ÿ≤ÿ±ÿßÿ± ÿßŸÑÿ•ÿØÿßÿ±ÿ©)
    function addGameToPage(game) {
      const gameGrid = document.getElementById('gameGrid');
      const gameCard = document.createElement('div');
      gameCard.className = 'game-card';
      gameCard.setAttribute('data-category', game.category);
      gameCard.setAttribute('data-game-id', game.id); // Store Firebase ID
      gameCard.style.opacity = '1';
      
      const gameLinksHtml = `
            <a href="${game.link}" target="_blank" class="play-btn">
              <i class="fas fa-play"></i> ÿ™ÿ¥ÿ∫ŸäŸÑ ÿßŸÑŸÑÿπÿ®ÿ©
            </a>
      `;

      gameCard.innerHTML = `
        <div class="game-image">
          <img src="${game.image}" alt="${game.name}" onerror="this.onerror=null;this.src='https://via.placeholder.com/260x260?text=Image+Not+Found';">
          ${game.badge ? `<span class="game-badge">${game.badge}</span>` : ''}
        </div>
        <div class="game-content">
          <h2>${game.name}</h2>
          <p>${game.description}</p>
          <div class="game-links">
            ${gameLinksHtml}
            ${IS_ADMIN_LOGGED_IN ? `
                <button class="edit-btn" onclick="showEditGameForm('${game.id}')">
                  <i class="fas fa-edit"></i> ÿ™ÿπÿØŸäŸÑ
                </button>
                <button class="delete-btn" onclick="deleteGame('${game.id}', '${game.name}')">
                  <i class="fas fa-trash-alt"></i> ÿ≠ÿ∞ŸÅ
                </button>
            ` : ''}
          </div>
          <div class="game-stats">
            <div class="stat"><i class="fas fa-star"></i> ${game.rating || 'N/A'}</div>
            <div class="stat"><i class="fas fa-user-friends"></i> ${game.players || 'N/A'}</div>
            <div class="stat"><i class="fas fa-clock"></i> ${game.time || 'N/A'}</div>
          </div>
        </div>
      `;
      
      // Add the game card to the grid
      gameGrid.appendChild(gameCard); 
    }

    // New function to update admin buttons visibility on all game cards
    function updateGameCardAdminButtons() {
        document.querySelectorAll('.game-card').forEach(card => {
            const gameId = card.getAttribute('data-game-id');
            const gameLinksDiv = card.querySelector('.game-links');
            
            // Remove existing admin buttons if any
            let existingEditBtn = gameLinksDiv.querySelector('.edit-btn');
            let existingDeleteBtn = gameLinksDiv.querySelector('.delete-btn');
            if (existingEditBtn) existingEditBtn.remove();
            if (existingDeleteBtn) existingDeleteBtn.remove();

            if (IS_ADMIN_LOGGED_IN) {
                const editButton = document.createElement('button');
                editButton.className = 'edit-btn';
                editButton.innerHTML = '<i class="fas fa-edit"></i> ÿ™ÿπÿØŸäŸÑ';
                editButton.onclick = () => showEditGameForm(gameId); 
                gameLinksDiv.appendChild(editButton);

                const deleteButton = document.createElement('button');
                deleteButton.className = 'delete-btn';
                deleteButton.innerHTML = '<i class="fas fa-trash-alt"></i> ÿ≠ÿ∞ŸÅ';
                deleteButton.onclick = () => deleteGame(gameId, allGamesData[gameId].name);
                gameLinksDiv.appendChild(deleteButton);
            }
        });
    }

    // 10. ÿ™ÿµŸÅŸäÿ© ÿßŸÑÿ£ŸÑÿπÿßÿ® (ÿßŸÑŸÉŸàÿØ ÿßŸÑÿ£ÿµŸÑŸä ÿßŸÑÿÆÿßÿµ ÿ®ŸÉ)
    function filterGames() {
      const query = document.getElementById("searchInput").value.toLowerCase();
      const cards = document.querySelectorAll(".game-card");
      const activeCategory = document.querySelector('.filter-btn.active').getAttribute('data-category');
      
      let visibleCount = 0;
      
      cards.forEach(card => {
        const title = card.querySelector("h2").textContent.toLowerCase();
        const description = card.querySelector("p").textContent.toLowerCase();
        const category = card.getAttribute("data-category");
        
        const matchesSearch = title.includes(query) || description.includes(query);
        const matchesCategory = (activeCategory === 'all' || category === activeCategory);

        if (matchesSearch && matchesCategory) {
          card.style.display = "flex";
          visibleCount++;
        } else {
          card.style.display = "none";
        }
      });
      
      const existingNoResults = document.getElementById("noResults");
      if (existingNoResults) existingNoResults.remove();
      
      if (visibleCount === 0) {
        const gameGrid = document.getElementById("gameGrid");
        const noResults = document.createElement("div");
        noResults.className = "no-results";
        noResults.id = "noResults";
        noResults.innerHTML = `
          <i class="fas fa-search" style="font-size: 3rem; margin-bottom: 20px;"></i>
          <h3>ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÜÿ™ÿßÿ¶ÿ¨</h3>
          <p>ŸÑŸÖ ŸÜÿπÿ´ÿ± ÿπŸÑŸâ ÿ£ŸÑÿπÿßÿ® ÿ™ÿ∑ÿßÿ®ŸÇ ÿ®ÿ≠ÿ´ŸÉ. ÿ≠ÿßŸàŸÑ ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ŸÉŸÑŸÖÿßÿ™ ÿ£ÿÆÿ±Ÿâ.</p>
        `;
        gameGrid.appendChild(noResults);
      }
    }
    
    // 11. ÿßŸÑÿ™ÿµŸÅŸäÿ© ÿ≠ÿ≥ÿ® ÿßŸÑÿ™ÿµŸÜŸäŸÅ (ÿßŸÑŸÉŸàÿØ ÿßŸÑÿ£ÿµŸÑŸä ÿßŸÑÿÆÿßÿµ ÿ®ŸÉ)
    document.querySelectorAll('.filter-btn').forEach(button => {
      button.addEventListener('click', function() {
        document.querySelectorAll('.filter-btn').forEach(btn => {
          btn.classList.remove('active');
        });
        
        this.classList.add('active');
        filterGames(); // Just call filterGames, it will handle both search and category
      });
    });

    // --- Admin Functionality ---

    // Function to load games for management in the admin section
    function loadGamesForManagement() {
        gamesRef.orderByChild('timestamp').on('value', (snapshot) => {
            gameManagementList.innerHTML = ''; // Clear existing list
            const gamesData = snapshot.val();
            allGamesData = {}; // Clear and re-populate global storage

            const gamesArray = [];

            if (gamesData) {
                for (let key in gamesData) {
                    allGamesData[key] = gamesData[key]; // Store for easy access by ID
                    gamesArray.push({ id: key, ...gamesData[key] });
                }
                gamesArray.sort((a, b) => b.timestamp - a.timestamp); // Sort by newest
            }

            if (gamesArray.length === 0) {
                gameManagementList.innerHTML = `<p style="text-align: center; color: var(--text-secondary);">ŸÑÿß ÿ™Ÿàÿ¨ÿØ ÿ£ŸÑÿπÿßÿ® ŸÑÿ•ÿØÿßÿ±ÿ™Ÿáÿß.</p>`;
            } else {
                gamesArray.forEach(game => {
                    const item = document.createElement('div');
                    item.className = 'game-management-item';
                    item.setAttribute('data-game-id', game.id);
                    item.innerHTML = `
                        <span>${game.name}</span>
                        <div class="actions">
                            <button class="edit-btn-small" onclick="showEditGameForm('${game.id}')">
                                <i class="fas fa-edit"></i> ÿ™ÿπÿØŸäŸÑ
                            </button>
                            <button class="delete-btn-small" onclick="deleteGame('${game.id}', '${game.name}')">
                                <i class="fas fa-trash-alt"></i> ÿ≠ÿ∞ŸÅ
                            </button>
                        </div>
                    `;
                    gameManagementList.appendChild(item);
                });
            }
        }, (errorObject) => {
            console.error("Error loading games for management: " + errorObject.code);
            gameManagementList.innerHTML = `<p style="color: var(--danger); text-align: center;">ŸÅÿ¥ŸÑ ÿ™ÿ≠ŸÖŸäŸÑ ŸÇÿßÿ¶ŸÖÿ© ÿßŸÑÿ£ŸÑÿπÿßÿ® ŸÑŸÑÿ•ÿØÿßÿ±ÿ©.</p>`;
        });
    }

    // Function to show the edit game form and populate it
    function showEditGameForm(gameId) {
        const gameData = allGamesData[gameId]; // Retrieve from global storage
        if (!gameData) {
            alert('ÿÆÿ∑ÿ£: ŸÑŸÖ Ÿäÿ™ŸÖ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸâ ÿ®ŸäÿßŸÜÿßÿ™ ÿßŸÑŸÑÿπÿ®ÿ© ŸÑŸÑÿ™ÿπÿØŸäŸÑ.');
            return;
        }

        editGameForm.classList.add('active');
        editGameIdInput.value = gameId;
        editGameNameInput.value = gameData.name;
        editGameDescriptionInput.value = gameData.description;
        editGameCategorySelect.value = gameData.category;
        editGameImageInput.value = gameData.image;
        editGameLinkInput.value = gameData.link;
        editGameBadgeInput.value = gameData.badge || '';
        editGameRatingInput.value = gameData.rating || '';
        editGamePlayersInput.value = gameData.players || '';
        editGameTimeInput.value = gameData.time || '';

        // Scroll to the edit form
        editGameForm.scrollIntoView({ behavior: 'smooth' });
    }

    // Function to cancel editing a game
    function cancelEditGame() {
        editGameForm.classList.remove('active');
        // Clear form fields
        editGameIdInput.value = '';
        editGameNameInput.value = '';
        editGameDescriptionInput.value = '';
        editGameCategorySelect.value = 'puzzle'; // Reset to default
        editGameImageInput.value = '';
        editGameLinkInput.value = '';
        editGameBadgeInput.value = '';
        editGameRatingInput.value = '';
        editGamePlayersInput.value = '';
        editGameTimeInput.value = '';
    }

    // Function to update a game in Firebase
    function updateGame() {
        const gameId = editGameIdInput.value;
        if (!gameId) {
            alert('ÿÆÿ∑ÿ£: ŸÑÿß ŸäŸàÿ¨ÿØ ŸÖÿπÿ±ŸÅ ŸÑÿπÿ®ÿ© ŸÑŸÑÿ™ÿπÿØŸäŸÑ.');
            return;
        }

        const updatedData = {
            name: editGameNameInput.value,
            description: editGameDescriptionInput.value,
            category: editGameCategorySelect.value,
            image: editGameImageInput.value,
            link: editGameLinkInput.value,
            badge: editGameBadgeInput.value || null, // Store null if empty
            rating: editGameRatingInput.value || null,
            players: editGamePlayersInput.value || null,
            time: editGameTimeInput.value || null,
            // Keep original timestamp for sorting consistency, or update if desired
        };

        gamesRef.child(gameId).update(updatedData)
            .then(() => {
                alert(`ÿ™ŸÖ ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÑÿπÿ®ÿ© "${updatedData.name}" ÿ®ŸÜÿ¨ÿßÿ≠!`);
                cancelEditGame(); // Hide and clear the form
            })
            .catch(error => {
                console.error("Error updating game:", error);
                alert("ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑŸÑÿπÿ®ÿ©: " + error.message);
            });
    }

    // Function to delete a game from Firebase
    function deleteGame(gameId, gameName) {
        if (confirm(`ŸáŸÑ ÿ£ŸÜÿ™ ŸÖÿ™ÿ£ŸÉÿØ ÿ£ŸÜŸÉ ÿ™ÿ±ŸäÿØ ÿ≠ÿ∞ŸÅ ÿßŸÑŸÑÿπÿ®ÿ© "${gameName}"ÿü Ÿáÿ∞ÿß ÿßŸÑÿ•ÿ¨ÿ±ÿßÿ° ŸÑÿß ŸäŸÖŸÉŸÜ ÿßŸÑÿ™ÿ±ÿßÿ¨ÿπ ÿπŸÜŸá.`)) {
            gamesRef.child(gameId).remove()
                .then(() => {
                    alert(`ÿ™ŸÖ ÿ≠ÿ∞ŸÅ ÿßŸÑŸÑÿπÿ®ÿ© "${gameName}" ÿ®ŸÜÿ¨ÿßÿ≠.`);
                })
                .catch(error => {
                    console.error("Error deleting game:", error);
                    alert("ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£ ÿ£ÿ´ŸÜÿßÿ° ÿ≠ÿ∞ŸÅ ÿßŸÑŸÑÿπÿ®ÿ©: " + error.message);
                });
        }
    }

    // Function to update site password
    function updateSitePassword() {
        const newPass = newSitePasswordInput.value;
        const confirmPass = confirmNewSitePasswordInput.value;

        sitePasswordMessage.style.display = 'none'; // Clear previous messages
        sitePasswordMessage.style.color = 'var(--danger)'; // Reset color

        if (newPass === "") {
            sitePasswordMessage.textContent = 'ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ± ŸÑÿß ŸäŸÖŸÉŸÜ ÿ£ŸÜ ÿ™ŸÉŸàŸÜ ŸÅÿßÿ±ÿ∫ÿ©.';
            sitePasswordMessage.style.display = 'block';
            return;
        }
        if (newPass !== confirmPass) {
            sitePasswordMessage.textContent = 'ŸÉŸÑŸÖÿ™ÿß ÿßŸÑŸÖÿ±Ÿàÿ± ÿ∫Ÿäÿ± ŸÖÿ™ÿ∑ÿßÿ®ŸÇÿ™ŸäŸÜ.';
            sitePasswordMessage.style.display = 'block';
            return;
        }

        passwordsRef.update({ sitePassword: newPass })
            .then(() => {
                sitePasswordMessage.textContent = 'ÿ™ŸÖ ÿ™ÿ≠ÿØŸäÿ´ ŸÉŸÑŸÖÿ© ŸÖÿ±Ÿàÿ± ÿßŸÑŸÖŸàŸÇÿπ ÿ®ŸÜÿ¨ÿßÿ≠!';
                sitePasswordMessage.style.color = 'var(--success)';
                sitePasswordMessage.style.display = 'block';
                newSitePasswordInput.value = '';
                confirmNewSitePasswordInput.value = '';
                SITE_PASSWORD_FIREBASE = newPass; // Update local variable
            })
            .catch(error => {
                console.error("Error updating site password:", error);
                sitePasswordMessage.textContent = `ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£: ${error.message}`;
                sitePasswordMessage.style.color = 'var(--danger)';
                sitePasswordMessage.style.display = 'block';
            });
    }

    // Function to update admin password
    function updateAdminPassword() {
        const newPass = newAdminPasswordInput.value;
        const confirmPass = confirmNewAdminPasswordInput.value;

        adminPasswordMessage.style.display = 'none'; // Clear previous messages
        adminPasswordMessage.style.color = 'var(--danger)'; // Reset color

        if (newPass === "") {
            adminPasswordMessage.textContent = 'ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ± ŸÑÿß ŸäŸÖŸÉŸÜ ÿ£ŸÜ ÿ™ŸÉŸàŸÜ ŸÅÿßÿ±ÿ∫ÿ©.';
            adminPasswordMessage.style.display = 'block';
            return;
        }
        if (newPass !== confirmPass) {
            adminPasswordMessage.textContent = 'ŸÉŸÑŸÖÿ™ÿß ÿßŸÑŸÖÿ±Ÿàÿ± ÿ∫Ÿäÿ± ŸÖÿ™ÿ∑ÿßÿ®ŸÇÿ™ŸäŸÜ.';
            adminPasswordMessage.style.display = 'block';
            return;
        }

        passwordsRef.update({ adminPassword: newPass })
            .then(() => {
                adminPasswordMessage.textContent = 'ÿ™ŸÖ ÿ™ÿ≠ÿØŸäÿ´ ŸÉŸÑŸÖÿ© ŸÖÿ±Ÿàÿ± ÿßŸÑÿ•ÿØÿßÿ±ÿ© ÿ®ŸÜÿ¨ÿßÿ≠!';
                adminPasswordMessage.style.color = 'var(--success)';
                adminPasswordMessage.style.display = 'block';
                newAdminPasswordInput.value = '';
                confirmNewAdminPasswordInput.value = '';
                ADMIN_PASSWORD_FIREBASE = newPass; // Update local variable
            })
            .catch(error => {
                console.error("Error updating admin password:", error);
                adminPasswordMessage.textContent = `ÿ≠ÿØÿ´ ÿÆÿ∑ÿ£: ${error.message}`;
                adminPasswordMessage.style.color = 'var(--danger)';
                adminPasswordMessage.style.display = 'block';
            });
    }

    // Tab switching logic for admin panel
    document.querySelectorAll('.admin-tab-btn').forEach(button => {
        button.addEventListener('click', function() {
            document.querySelectorAll('.admin-tab-btn').forEach(btn => btn.classList.remove('active'));
            this.classList.add('active');

            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            const targetTab = this.getAttribute('data-tab');
            document.getElementById(targetTab + 'Tab').classList.add('active');

            // Optionally, clear password messages when switching tabs
            sitePasswordMessage.style.display = 'none';
            adminPasswordMessage.style.display = 'none';
        });
    });

    // 12. ÿ™ŸáŸäÿ¶ÿ© ÿßŸÑÿµŸÅÿ≠ÿ© ÿπŸÜÿØ ÿßŸÑÿ™ÿ≠ŸÖŸäŸÑ:
    document.addEventListener('DOMContentLoaded', function() {
      // The password page visibility is handled by the Firebase password load listener.
      
      // Load games initially
      loadGamesFromFirebase();
      
      // Initial focus for site password input
      if (sitePasswordInput) {
        sitePasswordInput.focus();
      }
    });

  </script>
</body>
</html>
